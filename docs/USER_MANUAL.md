# 用户操作手册

## 目录

- [系统登录](#系统登录)
- [用户管理](#用户管理)
- [角色权限管理](#角色权限管理)
- [主机管理](#主机管理)
- [WebShell 使用](#webshell-使用)
- [Ansible 自动化](#ansible-自动化)
- [监控告警](#监控告警)
- [网络探测](#网络探测)

## 系统登录

### 1. 访问系统

在浏览器中输入系统地址: `http://your-domain.com`

### 2. 输入登录信息

- **用户名**: 您的用户名
- **密码**: 您的密码
- **租户代码**: 您所属的租户代码（可选）

### 3. 点击登录

系统会验证您的身份信息，登录成功后跳转到仪表盘页面。

### 4. 忘记密码

如果忘记密码，请联系系统管理员重置密码。

## 用户管理

### 查看用户列表

1. 点击左侧菜单 "用户管理"
2. 查看用户列表，包括用户名、邮箱、角色、状态等信息
3. 使用搜索框可以快速查找用户

### 新增用户

1. 点击 "新增用户" 按钮
2. 填写用户信息：
   - **用户名**: 必填，用于登录
   - **邮箱**: 必填，用于接收通知
   - **密码**: 必填，至少 8 位
   - **全名**: 可选，用户的真实姓名
   - **角色**: 必选，分配用户角色
   - **状态**: 启用或禁用
3. 点击 "确定" 保存

### 编辑用户

1. 在用户列表中找到要编辑的用户
2. 点击 "编辑" 按钮
3. 修改用户信息
4. 点击 "确定" 保存

### 删除用户

1. 在用户列表中找到要删除的用户
2. 点击 "删除" 按钮
3. 确认删除操作

### 管理用户头像

1. 点击用户列表中的头像或编辑用户
2. 在头像编辑器中：
   - 选择头像风格（avataaars、bottts 等）
   - 调整头像参数（颜色、配件等）
   - 点击 "随机生成" 生成新头像
3. 点击 "保存" 应用更改

## 角色权限管理

### 查看角色列表

1. 点击左侧菜单 "角色管理"
2. 查看所有角色及其权限

### 新增角色

1. 点击 "新增角色" 按钮
2. 填写角色信息：
   - **角色名称**: 必填
   - **角色描述**: 可选
   - **权限配置**: 勾选该角色拥有的权限
3. 点击 "确定" 保存

### 编辑角色

1. 在角色列表中找到要编辑的角色
2. 点击 "编辑" 按钮
3. 修改角色信息和权限
4. 点击 "确定" 保存

### 删除角色

1. 在角色列表中找到要删除的角色
2. 点击 "删除" 按钮
3. 确认删除操作

**注意**: 如果角色正在被用户使用，无法删除。

## 主机管理

### 添加 SSH 主机

1. 点击左侧菜单 "主机管理"
2. 点击 "添加主机" 按钮
3. 填写主机信息：
   - **主机名称**: 必填，便于识别
   - **主机地址**: 必填，IP 地址或域名
   - **SSH 端口**: 默认 22
   - **用户名**: SSH 登录用户名
   - **认证方式**: 选择密码或密钥
   - **密码/密钥**: 根据认证方式填写
   - **描述**: 可选
4. 点击 "测试连接" 验证配置
5. 点击 "确定" 保存

### 查看主机信息

1. 在主机列表中点击主机名称
2. 查看主机详细信息：
   - 系统信息（操作系统、内核版本）
   - 硬件信息（CPU、内存、磁盘）
   - 网络信息
   - 性能指标

### 编辑主机

1. 在主机列表中找到要编辑的主机
2. 点击 "编辑" 按钮
3. 修改主机信息
4. 点击 "确定" 保存

### 删除主机

1. 在主机列表中找到要删除的主机
2. 点击 "删除" 按钮
3. 确认删除操作

## WebShell 使用

### 打开 WebShell

1. 在主机列表中找到目标主机
2. 点击 "WebShell" 按钮
3. 系统会打开一个新的终端窗口

### 使用终端

- **输入命令**: 在终端中输入 Linux 命令
- **执行命令**: 按 Enter 键执行
- **复制粘贴**: 
  - 复制: Ctrl+C 或右键复制
  - 粘贴: Ctrl+V 或右键粘贴
- **清屏**: 输入 `clear` 命令
- **退出**: 输入 `exit` 命令或关闭窗口

### 多标签管理

- **新建标签**: 点击 "+" 按钮
- **切换标签**: 点击标签名称
- **关闭标签**: 点击标签上的 "×" 按钮

### 会话管理

- **会话历史**: 查看历史会话记录
- **重新连接**: 如果连接断开，点击 "重新连接"

## Ansible 自动化

### 创建 Playbook

1. 点击左侧菜单 "Ansible 管理"
2. 点击 "新建 Playbook" 按钮
3. 填写 Playbook 信息：
   - **名称**: 必填
   - **描述**: 可选
   - **内容**: 编写 YAML 格式的 Playbook
4. 点击 "保存" 保存

### 编辑 Playbook

1. 在 Playbook 列表中找到要编辑的 Playbook
2. 点击 "编辑" 按钮
3. 使用在线编辑器修改 Playbook
4. 编辑器功能：
   - 语法高亮
   - 自动补全
   - 语法检查
5. 点击 "保存" 保存更改

### 执行 Playbook

1. 在 Playbook 列表中找到要执行的 Playbook
2. 点击 "执行" 按钮
3. 配置执行参数：
   - **目标主机**: 选择要执行的主机
   - **变量**: 设置执行变量（可选）
4. 点击 "确认执行"
5. 查看实时执行日志

### 查看执行历史

1. 点击 "执行历史" 标签
2. 查看所有执行记录
3. 点击记录可查看详细日志

### Playbook 示例

```yaml
---
- name: 安装 Nginx
  hosts: all
  become: yes
  tasks:
    - name: 更新 apt 缓存
      apt:
        update_cache: yes
        
    - name: 安装 Nginx
      apt:
        name: nginx
        state: present
        
    - name: 启动 Nginx 服务
      service:
        name: nginx
        state: started
        enabled: yes
```

## 监控告警

### 配置告警渠道

#### 邮箱告警

1. 点击左侧菜单 "监控告警" -> "告警渠道"
2. 点击 "新增渠道" 按钮
3. 选择渠道类型: "邮箱"
4. 填写配置信息：
   - **渠道名称**: 必填
   - **SMTP 服务器**: 邮件服务器地址
   - **SMTP 端口**: 默认 25 或 465
   - **发件人邮箱**: 发送告警的邮箱
   - **发件人密码**: 邮箱密码或授权码
   - **收件人邮箱**: 接收告警的邮箱（多个用逗号分隔）
5. 点击 "测试" 验证配置
6. 点击 "确定" 保存

#### 钉钉告警

1. 点击 "新增渠道" 按钮
2. 选择渠道类型: "钉钉"
3. 填写配置信息：
   - **渠道名称**: 必填
   - **机器人名称**: 便于识别
   - **Webhook 地址**: 钉钉机器人的 Webhook URL
   - **加签密钥**: 如果启用了加签，填写密钥
4. 点击 "测试" 验证配置
5. 点击 "确定" 保存

### 配置告警规则

1. 点击 "告警规则" 标签
2. 点击 "新增规则" 按钮
3. 填写规则信息：
   - **规则名称**: 必填
   - **监控指标**: 选择 CPU、内存、磁盘等
   - **条件**: 选择 >、<、>=、<= 等
   - **阈值**: 设置告警阈值
   - **持续时间**: 持续多久触发告警
   - **严重程度**: 信息、警告、严重
   - **监控主机**: 选择要监控的主机
   - **告警渠道**: 选择通知渠道
   - **静默期**: 告警后的静默时间
4. 点击 "确定" 保存

### 查看告警历史

1. 点击 "告警历史" 标签
2. 查看所有告警记录
3. 可以按状态、严重程度筛选
4. 点击记录查看详细信息

### 处理告警

- **确认告警**: 点击 "确认" 按钮，表示已知晓
- **忽略告警**: 点击 "忽略" 按钮，不再提醒
- **查看详情**: 点击告警记录查看详细信息

### 监控大屏

1. 点击 "监控大屏" 标签
2. 查看实时监控数据：
   - 主机状态概览
   - 告警统计
   - 性能趋势图表
3. 点击 "全屏" 按钮进入全屏模式

## 网络探测

### 创建探测分组

1. 点击左侧菜单 "网络探测" -> "探测分组"
2. 点击 "新增分组" 按钮
3. 填写分组信息：
   - **分组名称**: 必填
   - **描述**: 可选
   - **颜色**: 选择分组颜色标识
4. 点击 "确定" 保存

### 创建探测任务

1. 点击 "探测任务" 标签
2. 点击 "新增任务" 按钮
3. 填写任务信息：
   - **任务名称**: 必填
   - **所属分组**: 选择分组
   - **协议类型**: HTTP、HTTPS、WebSocket、TCP、UDP
   - **目标地址**: 要探测的 URL 或 IP
   - **探测间隔**: 自动探测的时间间隔（秒）
4. 根据协议类型配置额外参数：
   - **HTTP/HTTPS**: 请求方法、请求头、请求体
   - **TCP/UDP**: 端口号
5. 点击 "确定" 保存

### 执行探测

#### 主动探测

1. 在探测任务列表中找到任务
2. 点击 "主动探测" 按钮
3. 系统立即执行一次探测
4. 查看探测结果

#### 自动探测

1. 在探测任务列表中找到任务
2. 点击 "启动自动探测" 按钮
3. 系统按设定的间隔自动执行探测
4. 点击 "停止自动探测" 停止

### 查看探测结果

1. 点击 "探测监控" 标签
2. 选择要查看的探测任务
3. 查看实时探测状态和历史数据：
   - 响应时间趋势图
   - 成功率统计
   - 最近探测记录
4. 支持分页查看历史记录

### 配置探测告警

1. 点击 "探测告警" 标签
2. 点击 "新增告警规则" 按钮
3. 填写规则信息：
   - **规则名称**: 必填
   - **探测任务**: 选择要监控的任务
   - **条件类型**: 响应时间、状态码、可用性
   - **条件**: 选择 >、<、== 等
   - **阈值**: 设置告警阈值
   - **连续失败次数**: 连续失败多少次触发告警
   - **告警渠道**: 选择通知渠道
4. 点击 "确定" 保存

### 网络监控大屏

1. 点击 "监控大屏" 标签
2. 查看所有探测任务的实时状态
3. 按分组查看探测结果
4. 点击 "全屏" 进入全屏模式

## 常见问题

### Q1: 无法登录系统

**解决方案**:
1. 检查用户名和密码是否正确
2. 检查账号是否被禁用
3. 联系管理员重置密码

### Q2: 主机连接失败

**解决方案**:
1. 检查主机地址和端口是否正确
2. 检查用户名和密码/密钥是否正确
3. 检查网络连接是否正常
4. 检查防火墙设置

### Q3: WebShell 连接断开

**解决方案**:
1. 点击 "重新连接" 按钮
2. 检查网络连接
3. 检查主机是否在线

### Q4: Playbook 执行失败

**解决方案**:
1. 检查 Playbook 语法是否正确
2. 检查目标主机是否可达
3. 检查执行权限是否足够
4. 查看详细错误日志

### Q5: 未收到告警通知

**解决方案**:
1. 检查告警渠道配置是否正确
2. 测试告警渠道是否可用
3. 检查告警规则是否启用
4. 检查是否在静默期内

## 获取帮助

如有任何问题，请：

1. 查看本用户手册
2. 查看常见问题解答
3. 联系系统管理员
4. 提交工单或反馈

---

**祝您使用愉快！**
